---
title: "A Multifaceted Examination of the 2020 United States Presidential Election"
subtitle: "Understanding and Comparing how Identity-Based, Socio-Economic, and Regional Variables Shaped the Outcome"
author: 
  - Sima Shmuylovich
thanks: "Code and data are available at: https://github.com/sshmuylovich/us-election-2020.git"
date: March 16, 2024
date-format: long
abstract: "This study examines the factors that shaped support for the United States of America's Presidential Candidates, Joeseph Bidon and Donald J. Trump, during the 2020 federal election. Analyzing identity-based, socio-economic, and regional variables, we discovered that ... ... These insights offer a comprehensive understanding of the 2020 election dynamics, enabling more informed predictions for the upcoming 2024 election (potentially with the same candidates). This research contributes to a better grasp of American political aï¬€iliations, assisting citizens and policymakers in adapting to evolving electoral trends."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(statebins)
library(broom)
library(broom.mixed)
library(kableExtra)
library(rstanarm)
library(modelsummary)
```

# Introduction {#sec-introduction}
The 2020 federal elections saw Democrat Joesph Biden defeat Republican Donald J. Trump, winning 306 of 538 electoral votes, to become the 46th President of the United States (@citeTODO). With the 47th federal election quickly approaching in 2024 and both Biden and Trump being the presumptive nominees for their respective political parties (@citeTODO), this paper conducts an analysis on support for these two politicians, specifically examining identity-based, socio-economic, and regional variables. The estimand of interest in this research is the average causal effect of these variables on the likelihood of individuals expressing support for either Democratic Candidate Biden or Republican Candidate Trump.

By delving into identity-based (gender, age, and race), socio-economic (education level, employment status, and income), and regional factors (region, urban status, and state), this paper seeks to illuminate the multifaceted influences that shaped political support in the 2020 US Election. The objective is to unravel the complex dynamics that dictated electoral outcomes, thereby providing a better understanding of the American political landscape and a better ability to forecast potential shifts in voter alignment in anticipation of future elections.

The subsequent sections follow a structured format. @sec-data outlines the source and variables central to our analysis. @sec-model details the construction and methodology of the statistical models used. @sec-results presents the key findings of our analysis, while @sec-discussion critically reviews the content, addresses the implications of the results, acknowledges model limitations, and suggests potential research directions.

\newpage
# Data {#sec-data}
```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

election_data <- read_csv("../data/analysis_data/analysis_data.csv")
```
The data used in this paper was gathered from the 2020 Cooperative Election Study (CES) hosted on the Harvard Dataverse [@citeCES] and analyzed using R [@citeR] with help from `tidyverse` [@citeTidyverse], `rstanarm` [@citeRstanarm], `modelsummary` [@citeModelsummary], `testthat` [@citeTestthat], `here` [@citeHere], `knitr` [@citeKnitr], and `kableExtra` [@citeKableExtra].

## Cooperative Election Study 2020

The Cooperative Election Study (CES), previously known as the Cooperative Congressional Election Study, is an extensive research project aimed at understanding the intricacies of American electoral behavior, particularly focusing on congressional elections. Initiated in 2006, the CES has evolved to capture the nuances of how Americans perceive their representatives, their voting patterns, and the overall electoral experience, emphasizing the influence of political geography and social context. The methodology and scale of this study allow for an in-depth analysis of legislative constituencies across the United States, offering a unique perspective on the democratic process at both state and national levels [@citeCES].

The 2020 CES survey was conducted over the Internet by YouGov, a British international Internet-based market research and data analytics firm. Participants were interviewed from September 29 to November 2, 2020 (for pre-election data), and from November 8 to December 14, 2020 (for post-election data). A total of 61000 participants were interviewed for pre-election and 51551 returned for post-election interviews. The dataset includes 717 variables, many of which could have been included in the analysis but was narrowed down to 9 variables that could correlate with candidate support. These variables are gathered from the CPS portion of the survey with no open-ended answers and assigned numerical values with labels.The data was released on March 26, 2021 [@citeCES].

## Identity-Based Variables

Gender was picked as one of the identity-based variables because gender can influence an individual's policy preferences. For instance, women might prioritize issues such as healthcare, reproductive rights, and gender equality more than men. Understanding gender differences in voting behavior can help in analyzing how these issues impact elections. From a preliminary look at @fig-gender_prop, we can see that gender does influence voting behavior, this paper aims to further analysis how.  

Age was picked as one of the identity-based variables because different age groups often hold distinct values and perspectives shaped by their generational experiences. For instance, younger voters may prioritize climate change, education, and jobs, while older voters may focus on healthcare, social security, and national security. From a preliminary look at @fig-age_prop, we can see that age influences voting behavior, this paper aims to further analysis how.

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_age <- election_data %>%
  group_by(age) %>%
  summarise(
    "Biden" = sum(voted_for == "Biden")/n(),
    "Trump" = sum(voted_for == "Trump")/n(),
  )

voting_age <- reshape2::melt(voting_age, id.vars = "age")
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-age_prop
#| fig-cap: Proportion of Votes by Age in the 2020 Election

ggplot(voting_age, aes(x = age, y = value, color = variable, group = variable)) +
  geom_line() + # Draw lines
  geom_point() + # Add points to indicate actual data points
  scale_color_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +
  labs(title = "Proportion of Votes for Joe Biden or Donald Trump by Age",
       x = "Age",
       y = "Proportion of Votes",
       color = "Presidential Candidate") +
  theme_minimal()
```

Race was picked as one of the identity-based variables because different racial and ethnic groups have unique historical and social experiences that influence their political views and behaviors. For example, policies on immigration, law enforcement, and affirmative action may be viewed differently by voters of different racial backgrounds. The Pew Research Center found that in the 2022 midterms, Black voters supported Democrats by overwhelming margins: 93% voted for Democrats while only 5% supported Republicans. This is similar to levels of support in 2020, 2018 and 2016 [@citePewRace]. From a preliminary look at @fig-race_prop, we can see that race influences voting behavior, this paper aims to further analysis how.

## Socio-Economic Variables

Education was picked as one of the socio-economic variables because education level is closely linked to an individual's policy preferences and political awareness. Higher education levels often correlate with more liberal attitudes on social issues and a greater engagement in political processes. From a preliminary look at @fig-education_prop, we can see that education influences voting behavior, this paper aims to further analysis how.

Employment status was picked as one of the socio-economic variables because employment status directly affects an individual's economic security and outlook, influencing their priorities at the polls. For example, unemployed or underemployed voters might prioritize job creation, economic recovery, and social safety nets more highly than those securely employed. From a preliminary look at @fig-employment_status_prop, we can see that employment status influences voting behavior, this paper aims to further analysis how.

Income was picked as one of the socio-economic variables because income levels influence voters' economic interests, with higher-income individuals potentially prioritizing tax policies and economic strategies that favor wealth preservation, while lower-income voters might focus on income redistribution, minimum wage increases, and access to affordable healthcare. From a preliminary look at @fig-income_prop, we can see that income influences voting behavior, this paper aims to further analysis how.

## Regional Variables

Region was picked as one of the regional variables because different regions in a country often have unique cultural and historical contexts that shape residents' values, attitudes, and political leanings. For example, historical voting patterns, regional industries, and local issues can significantly influence regional voting behaviors.
Furthermore, specific issues may be more pressing in certain regions than others, such as environmental concerns in areas prone to climate-related disasters or economic policies in regions dominated by particular industries. From a preliminary look at @fig-region_prop, we can see that region does influence voting behavior, this paper aims to further analysis how.  

Urban status was picked as one of the regional variables because urban, suburban, and rural areas differ markedly in their socio-economic and demographic compositions. These differences can lead to distinct political priorities and voting behaviors, with urban areas often leaning more towards progressive policies and rural areas favoring conservative stances, influenced by factors like population density, diversity, and economic opportunities. The concentration of services and infrastructure in urban areas, as opposed to their scarcity in rural regions, can influence voter concerns and priorities, such as public transportation, education, and healthcare services. From a preliminary look at @fig-urban_status_prop, we can see that age influences voting behavior, this paper aims to further analysis how.

State was picked as one of the regional variables because state-level policies and governance can significantly affect residents' lives, influencing their political preferences. Issues such as education, healthcare, taxation, and environmental regulation can vary widely by state, affecting voting behavior. Some states also have a higher electoral significance due to their size, demographic composition, or status as swing states. Understanding the political dynamics at the state level is crucial for predicting and analyzing election outcomes, especially in systems like the United States' Electoral College. From a preliminary look at @fig-state_prop, we can see that age influences voting behavior, this paper aims to further analysis how.

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_state_map <- election_data %>%
  group_by(state) %>%
  summarise(
    total_votes = n(), 
    biden_votes = sum(voted_for == "Biden"), 
    prop = biden_votes / total_votes 
  )

voting_state_map$state <- as.character(voting_state_map$state)
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-state_prop
#| fig-cap: Proportion of Votes by State in the 2020 Election

voting_state_map %>% 
  mutate(statename = str_to_title(state)) %>% 
  ggplot(aes(fill = prop, state = statename)) + 
  geom_statebins() + 
  scale_fill_gradient2(low = "#E81B23", high = "#0A3161",
                       mid = "white", midpoint = mean(voting_state_map$prop)) +
  theme_classic() +
  theme(axis.line = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank()) +
  labs(fill = "Proportion Voting \nfor Biden",
       title = "Proportion of Votes by US State")
```

## Measurment
Age was calculated in years based on the year of birth the respondent inputted. Gender and Race were given a number with a corresponding label based on which radio button the respondent selected. When cleaning the data the following changes were made to the raw data: age was categorized as seen in @tbl-age_var, gender was limited to Male and Female, and race was mapped from a number to the categories seen in @tbl-race_var. 

A preview of the identity-based variables used in this paper can be seen in @tbl-identity_based_var.

```{r, echo=FALSE}
#| label: tbl-identity_based_var
#| tbl-cap: Sample of Identity-Based Data
head(election_data, 5) %>% 
  select(gender, age_bucket, race) %>% 
  kable()
```

Education, employment status, and income were all given a number with a corresponding label based on which radio button the respondent selected. When cleaning the data the following changes were made to the raw data: education was mapped from a number to the categories seen in @tbl-education_var, employment status was mapped from a number to the categories seen in @tbl-employment_status_var, and income was mapped from a number to the categories seen in @tbl-income_var.

A preview of the socio-economic variables used in this paper can be seen in @tbl-socio_economic_var.

```{r, echo=FALSE}
#| label: tbl-socio_economic_var
#| tbl-cap: Sample of Socio-Economic Data
head(election_data, 5) %>% 
  select(education, employment_status, income) %>% 
  kable()
```

Region, urban status, and state were all given a number with a corresponding label based on which radio button the respondent selected. When cleaning the data the following changes were made to the raw data: region was mapped to the categories seen in the CES survey (Northeast, Midwest, South, West), urban status was mapped from a number to the categories seen in the CES survey (City, Suburb, Town, Rural Area), and state was mapped from a number to the categories seen in the CES survey (all 50 states and the District of Columbia).

A preview of the regional variables used in this paper can be seen in @tbl-regional_var.

```{r, echo=FALSE}
#| label: tbl-regional_var
#| tbl-cap: Sample of Regional Data
head(election_data, 5) %>% 
  select(region, urban_status, state) %>% 
  kable()
```

It is important to note that this study is only interested in participants who were registered to vote in the 2020 election and who voted for either Biden or Trump, this was reflectcted in the data cleaning process.

\newpage
# Model {#sec-model}
For a comprehensive analysis of how identity-based, socio-economic, and regional factors influenced voting behavior in the 2020 US Election, a generalized linear model (GLM) is an effective statistical approach. Given the nature of the dependent variable which is binary (voted for Joe Biden vs. Donald Trump), logistic regression is a suitable model within the GLM framework. This model predicts the log-odds of the outcome as a linear combination of the independent variables.

## Identity-Based Model Setup
Define $y_i$ as who the respondent voted for and equal to 1 if Joe Biden and 0 if Donald Trump. Then gender, age, and race are the respective answers of the respondent.

\begin{align} 
y_i|\pi_i &\sim \mbox{Bern}(\pi_i) \\
\text{logit}(\pi_i) &= \beta_0 + \beta_1 \times \text{gender}_i + \beta_2 \times \text{age}_i + \beta_3 \times \text{race}_i\\
\beta_0 &\sim \text{Normal}(0, 2.5)\\
\beta_1 &\sim \text{Normal}(0, 2.5) \\ 
\beta_2 &\sim \text{Normal}(0, 2.5) \\ 
\beta_3 &\sim \text{Normal}(0, 2.5)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`. The use of Normal(0, 2.5) priors is a conservative choice that imposes minimal prior beliefs on the magnitude of the coefficients. It is used in Bayesian logistic regression to reflect a lack of strong prior knowledge while still allowing the data to inform the final posterior distributions.

## Socio-Economic Model Setup
Define $y_j$ as who the respondent voted for and equal to 1 if Joe Biden and 0 if Donald Trump. Then education, employment status, and income are the respective answers of the respondent.

\begin{align} 
y_j|\pi_j &\sim \mbox{Bern}(\pi_j) \\
\text{logit}(\pi_j) &= \beta_0 + \beta_1 \times \text{education}_j + \beta_2 \times \text{eployment status}_j + \beta_3 \times \text{income}_j\\
\beta_0 &\sim \text{Normal}(0, 2.5)\\
\beta_1 &\sim \text{Normal}(0, 2.5) \\ 
\beta_2 &\sim \text{Normal}(0, 2.5) \\ 
\beta_3 &\sim \text{Normal}(0, 2.5)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`. The use of Normal(0, 2.5) priors is a conservative choice that imposes minimal prior beliefs on the magnitude of the coefficients. It is used in Bayesian logistic regression to reflect a lack of strong prior knowledge while still allowing the data to inform the final posterior distributions.

## Regional Model Setup
Define $y_k$ as who the respondent voted for and equal to 1 if Joe Biden and 0 if Donald Trump. Then region, urban status, and state are the respective answers of the respondent.

\begin{align} 
y_k|\pi_k &\sim \mbox{Bern}(\pi_k) \\
\text{logit}(\pi_k) &= \beta_0 + \beta_1 \times \text{region}_k + \beta_2 \times \text{urban status}_k + \beta_3 \times \text{state}_k\\
\beta_0 &\sim \text{Normal}(0, 2.5)\\
\beta_1 &\sim \text{Normal}(0, 2.5) \\ 
\beta_2 &\sim \text{Normal}(0, 2.5) \\ 
\beta_3 &\sim \text{Normal}(0, 2.5)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`. The use of Normal(0, 2.5) priors is a conservative choice that imposes minimal prior beliefs on the magnitude of the coefficients. It is used in Bayesian logistic regression to reflect a lack of strong prior knowledge while still allowing the data to inform the final posterior distributions.

\newpage
# Results {#sec-results}
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

identity_based_model <-
  readRDS("../models/identity_based_model_reduced.rds")

socio_economic_model <-
  readRDS("../models/socio_economic_model_reduced.rds")

regional_model <-
  readRDS("../models/regional_model_reduced.rds")
```

## Identity-Based Results

```{r}
#| echo: false
#| eval: true
#| label: tbl-identity_based_model_results
#| tbl-cap: "Explanatory model of support for the 2020 Presidential Candidates based on gender, age, and race"
#| warning: false
#| fig-height: 5
#| scale: 

identity_based_coefficients <- tidy(identity_based_model, conf.int = TRUE)

kable(identity_based_coefficients, 
      caption = "Identity-Based Coefficients", 
      digits = 2) 
```

```{r}
#| echo: false
#| eval: true
#| label: fig-identity_based_coefficient_estimates
#| fig-cap: "Explanatory graph of support for the 2020 Presidential Candidates based on gender, age, and race"
#| warning: false

identity_based_coefficients <- tidy(identity_based_model, conf.int = TRUE)


identity_based_coefficients %>%
  ggplot(aes(x = estimate, y = term)) +
  geom_point(aes(color = ifelse(estimate > 0, "Biden", "Trump"))) +  # Conditional color for points
  geom_errorbar(aes(xmin = conf.low, xmax = conf.high, color = ifelse(estimate > 0, "Biden", "Trump"))) +  # Conditional color for error bars
  labs(title = "Identity-Based Coefficient Estimates",
       x = "Estimate", y = "Coefficient", color = "Presidential Candidate") +
  scale_color_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +  # Custom colors
  theme(axis.text.y = element_text(size = 5),
        legend.position = "bottom")  # Move legend to bottom
```

## Socio-Economic Results

```{r}
#| echo: false
#| eval: true
#| label: tbl-socio_economic_model_results
#| tbl-cap: "Explanatory model of support for the 2020 Presidential Candidates based on education, employment status, and income"
#| warning: false
#| fig-height: 5
#| scale: 

socio_economic_coefficients <- tidy(socio_economic_model, conf.int = TRUE)

kable(socio_economic_coefficients, 
      caption = "Socio-Economic Coefficients", 
      digits = 2) 
```

```{r}
#| echo: false
#| eval: true
#| label: fig-socio_economic_coefficient_estimates
#| fig-cap: "Explanatory graph of support for the 2020 Presidential Candidates based on education, employment status, and income"
#| warning: false

socio_economic_coefficients <- tidy(socio_economic_model, conf.int = TRUE)

socio_economic_coefficients %>%
  ggplot(aes(x = estimate, y = term)) +
  geom_point(aes(color = ifelse(estimate > 0, "Biden", "Trump"))) +  # Conditional color for points
  geom_errorbar(aes(xmin = conf.low, xmax = conf.high, color = ifelse(estimate > 0, "Biden", "Trump"))) +  # Conditional color for error bars
  labs(title = "Socio-Economic Coefficient Estimates",
       x = "Estimate", y = "Coefficient", color = "Presidential Candidate") +
  scale_color_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +  # Custom colors
  theme(axis.text.y = element_text(size = 5),
        legend.position = "bottom")  # Move legend to bottom
```

```{r}
#| echo: false
#| eval: true
#| label: tbl-regional_model_results
#| tbl-cap: "Explanatory model of support for the 2020 Presidential Candidates based on region, urban status, and state"
#| warning: false
#| fig-height: 5
#| scale: 

regional_coefficients <- tidy(regional_model, conf.int = TRUE)

kable(regional_coefficients, 
      caption = "Regional Model Coefficients", 
      digits = 2) 
```

## Regional Results

```{r}
#| echo: false
#| eval: true
#| label: fig-regional_coefficient_estimates
#| fig-cap: "Explanatory graph of support for the 2020 Presidential Candidates based on region, urban status, and state"
#| warning: false

regional_coefficients <- tidy(regional_model, conf.int = TRUE)

regional_coefficients %>%
  ggplot(aes(x = estimate, y = term)) +
  geom_point(aes(color = ifelse(estimate > 0, "Biden", "Trump"))) +  # Conditional color for points
  geom_errorbar(aes(xmin = conf.low, xmax = conf.high, color = ifelse(estimate > 0, "Biden", "Trump"))) +  # Conditional color for error bars
  labs(title = "Socio-Economic Coefficient Estimates",
       x = "Estimate", y = "Coefficient", color = "Candidate") +
  scale_color_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +  # Custom colors
  theme(axis.text.y = element_text(size = 5),
        legend.position = "bottom")  # Move legend to bottom
```

# Discussion {#sec-discussion}

# Appendix {#sec-appendix}
```{r, echo=FALSE}
#| label: tbl-age_var
#| tbl-cap: Age bucket variable values
data.frame(age_bucket = unique(election_data$age_bucket)) %>%
  kable()
```

```{r, echo=FALSE}
#| label: tbl-race_var
#| tbl-cap: Race variable values
data.frame(race = unique(election_data$race)) %>%
  kable()
```

```{r, echo=FALSE}
#| label: tbl-education_var
#| tbl-cap: Education variable values
data.frame(education = unique(election_data$education)) %>%
  kable()
```

```{r, echo=FALSE}
#| label: tbl-employment_status_var
#| tbl-cap: Eployment status variable values
data.frame(emoloyment_status = unique(election_data$employment_status)) %>%
  kable()
```

```{r, echo=FALSE}
#| label: tbl-income_var
#| tbl-cap: Income variable values
data.frame(income = unique(election_data$income)) %>%
  kable()
```

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_gender <- election_data %>%
  group_by(gender) %>%
  summarise(
    "Biden" = sum(voted_for == "Biden")/n(), 
    "Trump" = sum(voted_for == "Trump")/n(), 
  )

voting_gender <- reshape2::melt(voting_gender, id.vars = "gender")
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-gender_prop
#| fig-cap: Proportion of Votes by Gender in the 2020 Election

ggplot(voting_gender, aes(x = gender, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +
  labs(y = "Proportion of Votes", x = "Gender", fill = "Presidential Candidate", title = "Proportion of Votes by Gender") +
  theme_minimal()
```

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_race<- election_data %>%
  group_by(race) %>%
  summarise(
    "Biden" = sum(voted_for == "Biden")/n(), 
    "Trump" = sum(voted_for == "Trump")/n(), 
  )

voting_race <- reshape2::melt(voting_race, id.vars = "race")
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-race_prop
#| fig-cap: Proportion of Votes by Race in the 2020 Election

ggplot(voting_race, aes(x = race, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +
  labs(y = "Proportion of Votes", x = "Race", fill = "Presidential Candidate", title = "Proportion of Votes by Race") +
  theme_minimal()
```

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_education<- election_data %>%
  group_by(education) %>%
  summarise(
    "Biden" = sum(voted_for == "Biden")/n(), 
    "Trump" = sum(voted_for == "Trump")/n(), 
  )

voting_education <- reshape2::melt(voting_education, id.vars = "education")
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-education_prop
#| fig-cap: Proportion of Votes by Education in the 2020 Election

ggplot(voting_education, aes(x = "", y = value, fill = variable)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y") + 
  scale_fill_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +
  labs(y = "Proportion of Votes", x = "", fill = "Presidential Candidate",
       title = "Proportion of Votes by Education") +
  facet_wrap(~education) + 
  theme_minimal() +
  theme(axis.title = element_blank(),
        axis.text = element_blank(), 
        axis.ticks = element_blank(),
        panel.grid = element_blank(),
        )
```

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_emplyment_status <- election_data %>%
  group_by(employment_status) %>%
  summarise(
    "Biden" = sum(voted_for == "Biden")/n(), 
    "Trump" = sum(voted_for == "Trump")/n(), 
  )

voting_emplyment_status <- reshape2::melt(voting_emplyment_status, id.vars = "employment_status")
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-employment_status_prop
#| fig-cap: Proportion of Votes by Employment Status in the 2020 Election

ggplot(voting_emplyment_status, aes(x = employment_status, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +
  labs(y = "Proportion of Votes", x = "Employment Status", fill = "Presidential Candidate", title = "Proportion of Votes by Employment Status") +
  theme_minimal()
```

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_income<- election_data %>%
  group_by(income) %>%
  summarise(
    "Biden" = sum(voted_for == "Biden")/n(), 
    "Trump" = sum(voted_for == "Trump")/n(), 
  )

voting_income <- reshape2::melt(voting_income, id.vars = "income")
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-income_prop
#| fig-cap: Proportion of Votes by Income in the 2020 Election

ggplot(voting_income, aes(x = "", y = value, fill = variable)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y") + 
  scale_fill_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +
  labs(y = "Proportion of Votes", x = "", fill = "Presidential Candidate",
       title = "Proportion of Votes by Income") +
  facet_wrap(~income) + 
  theme_minimal() +
  theme(axis.title = element_blank(),
        axis.text = element_blank(), 
        axis.ticks = element_blank(),
        panel.grid = element_blank(),
        )
```

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_region_map <- election_data %>%
  group_by(region) %>%
  summarise(
    total_votes = n(), 
    biden_votes = sum(voted_for == "Biden"), 
    prop = biden_votes / total_votes 
  )

voting_region_map <- election_data %>%
  full_join(voting_region_map, by = "region") %>%
  group_by(state, total_votes, biden_votes, prop) %>%
  summarise()

voting_region_map$state <- as.character(voting_region_map$state)
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-region_prop
#| fig-cap: Proportion of Votes by Region in the 2020 Election

voting_region_map %>% 
  mutate(statename = str_to_title(state)) %>% 
  ggplot(aes(fill = prop, state = statename)) + 
  geom_statebins() + 
  scale_fill_gradient2(low = "#E81B23", high = "#0A3161",
                       mid = "white", midpoint = mean(voting_region_map$prop)) +
  theme_classic() +
  theme(axis.line = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank()) +
  labs(fill = "Proportion Voting \nfor Biden",
       title = "Proportion of Votes by US Region")
```

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

voting_urban_status <- election_data %>%
  group_by(urban_status) %>%
  summarise(
    "Biden" = sum(voted_for == "Biden")/n(), 
    "Trump" = sum(voted_for == "Trump")/n(), 
  )

voting_urban_status <- reshape2::melt(voting_urban_status, id.vars = "urban_status")
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-urban_status_prop
#| fig-cap: Proportion of Votes by Urban Status in the 2020 Election

ggplot(voting_urban_status, aes(x = "", y = value, fill = variable)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y") + 
  scale_fill_manual(values = c("Biden" = "#0A3161", "Trump" = "#E81B23")) +
  labs(y = "Proportion of Votes", x = "", fill = "Presidential Candidate",
       title = "Proportion of Votes by Urban Status") +
  facet_wrap(~urban_status) + 
  theme_minimal() +
  theme(axis.title = element_blank(),
        axis.text = element_blank(), 
        axis.ticks = element_blank(),
        panel.grid = element_blank(),
        )
```

\newpage
# References {#sec-references}

